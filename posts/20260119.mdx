---
title: "Next.js API Routes vs tRPC: νƒ€μ… μ•μ „ν• API ν†µμ‹ μ μ§„ν™”"
description: "as νƒ€μ… λ‹¨μ–Έμ΄ λ¶μ•ν–λ κ²½ν—μ—μ„ μ‹μ‘λ tRPC λ„μ…κΈ°."
date: "2026-01-19"
published: true
category: "Frontend"
tag: "Next.js, TypeScript, API, tRPC"
---

```typescript
return (await response.json()) as { review: string; message: string };
```

μ΄ μ½”λ“λ¥Ό λ³Ό λ•λ§λ‹¤ λ¶μ•ν–μµλ‹λ‹¤.

`as`λ” TypeScriptμ—κ² "λ‚΄ λ§μ„ λ―Ώμ–΄"λΌκ³  κ°•μ”ν•λ” κ²ƒμ΄κ±°λ“ μ”. μ„λ²„κ°€ μ‹¤μ λ΅ λ¬΄μ—‡μ„ λ°ν™ν•λ“ , μ»΄νμΌλ¬λ” λ¨λ¦…λ‹λ‹¤. μ„λ²„μ—μ„ `message`λ¥Ό `status`λ΅ λ°”κΏ”λ„ IDEλ” κ²½κ³ ν•μ§€ μ•μµλ‹λ‹¤. λ°νƒ€μ„μ— ν„°μ§€κ² λλ”κ±°μ£ .

μ‹¤μ λ΅ μ΄λ° λ²„κ·Έλ¥Ό κ²κΈ°λ„ ν–μµλ‹λ‹¤. μ„λ²„ μ‘λ‹µ κµ¬μ΅°λ¥Ό λ³€κ²½ν–λ”λ°, ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ `as` λ‹¨μ–Έμ„ κΉλΉ΅ν•κ³  μμ •ν•μ§€ μ•μ•μ—λκ±°μ£ . μ΄μ—λ”°λΌ, `undefined` μ—λ¬κ°€ ν„°μ΅μ—μµλ‹λ‹¤.

μ΄λ¬ν• λ¬Έμ λ¥Ό ν•΄κ²°ν•κ³ μ tRPC λ„μ…μ„ μƒκ°ν•κ² λμ—μµλ‹λ‹¤.

---

> μ΄ κΈ€μ—μ„λ” λ‘ κ°€μ§€ λ°©μ‹μ„ κ°κ΄€μ μΌλ΅ λΉ„κµν•λ©΄μ„, μ™ tRPCλ΅μ μ „ν™μ„ κ²°μ •ν–λ”μ§€ κ·Έ κ³Όμ •μ„ κ³µμ ν•©λ‹λ‹¤.
> 1. **Next.jsμ κΈ°λ³Έ API Routes** (App Routerμ Route Handlers)
> 2. **tRPC** (TypeScript Remote Procedure Call)

---

## λ¬Έμ  ν”„λ΅μ νΈμ API κµ¬μ΅°

μ κ°€ μ§„ν–‰ν•κ³  μλ ν”„λ΅μ νΈλ” Next.js App Routerμ **Route Handlers**λ¥Ό μ‚¬μ©ν•μ—¬ APIλ¥Ό κµ¬ν„ν•κ³  μμµλ‹λ‹¤.

### λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
app/api/
β”β”€β”€ admin/
β”‚   β”β”€β”€ prompts/route.ts
β”‚   β””β”€β”€ whitelist/route.ts
β”β”€β”€ generate-review/route.ts
β”β”€β”€ edit-review/route.ts
β”β”€β”€ analyze-style/route.ts
β””β”€β”€ style-profile/route.ts
```

### μ„λ²„ μ‚¬μ΄λ“ (API Route)

```typescript
// app/api/generate-review/route.ts
import { createGenerateReviewHandler } from '@/features/review/api/create-generate-review-handler';
import { generateReviewWithClaudeAPI } from '@/features/review/lib/review-generator';

export const POST = createGenerateReviewHandler({
  validateReviewPayload: isValidReviewPayload,
  readStyleProfile,
  generateReview: generateReviewWithClaudeAPI,
  saveReviewToDB,
  getUserStatus,
  incrementUsageCount,
});
```

### ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ (API νΈμ¶)

```typescript
// src/features/review/api/review-api.ts
export const generateReview = async (
  payload: ReviewPayload,
): Promise<{ review: string; message: string }> => {
  const response = await fetch('/api/generate-review', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload),
  });

  if (!response.ok) {
    const errorData = await response.json().catch(() => ({}));
    throw new Error(errorData.error || 'λ¦¬λ·° μƒμ„±μ— μ‹¤ν¨ν–μµλ‹λ‹¤.');
  }

  return (await response.json()) as { review: string; message: string };
};
```

### μ»΄ν¬λ„νΈμ—μ„μ μ‚¬μ©

```typescript
import { generateReview } from '@/features/review/api/review-api';

const handleGenerate = async () => {
  try {
    const result = await generateReview({
      placeName: 'μ„μΈ λ§›μ§‘',
      placeUrl: 'https://example.com',
      userDraft: 'μ •λ§ λ§›μμ—μ–΄μ”!',
    });
    console.log(result.review);
  } catch (error) {
    console.error(error);
  }
};
```

---

## Next.js API Routesμ μ‘λ™ λ°©μ‹

Next.js API Routesλ” μ„λ²„λ¦¬μ¤ ν•¨μλ΅ λ™μ‘ν•λ©°, HTTP λ©”μ„λ“λ³„λ΅ ν•Έλ“¤λ¬λ¥Ό exportν•λ” λ°©μ‹μ…λ‹λ‹¤.

### μ¥μ 

1. **λΉ λ¥Έ μ‹μ‘**: λ³„λ„ μ„¤μ • μ—†μ΄ `app/api` ν΄λ”μ— νμΌλ§ λ§λ“¤λ©΄ λ¨
2. **μµμ™ν• REST API ν¨ν„΄**: HTTP λ©”μ„λ“(GET, POST, PUT, DELETE) μ‚¬μ©
3. **μ μ—°μ„±**: μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ(λ¨λ°”μΌ μ•±, λ‹¤λ¥Έ μ„λΉ„μ¤)μ—μ„λ„ νΈμ¶ κ°€λ¥
4. **λ‹¨μμ„±**: μ¶”κ°€ λΌμ΄λΈλ¬λ¦¬ μ—†μ΄ Next.jsλ§μΌλ΅ μ™„κ²°

### λ‹¨μ 

1. **νƒ€μ… μ•μ •μ„± λ¶€μ΅±**
   ```typescript
   // μ„λ²„μ—μ„ μ •μν• νƒ€μ…
   type Response = { review: string; message: string };
   
   // ν΄λΌμ΄μ–ΈνΈμ—μ„λ” νƒ€μ…μ„ μλ™μΌλ΅ as λ‹¨μ–Έν•΄μ•Ό ν•¨
   return (await response.json()) as { review: string; message: string };
   ```
   - μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„ νƒ€μ…μ΄ μλ™μΌλ΅ λ™κΈ°ν™”λμ§€ μ•μ
   - νƒ€μ… λ¶μΌμΉ μ‹ λ°νƒ€μ„ μ—λ¬ λ°μƒ κ°€λ¥

2. **λ³΄μΌλ¬ν”λ μ΄νΈ μ½”λ“ λ°λ³µ**
   ```typescript
   // λ¨λ“  API νΈμ¶λ§λ‹¤ λ°λ³µλλ” μ½”λ“
   const response = await fetch('/api/...', {
     method: 'POST',
     headers: { 'Content-Type': 'application/json' },
     body: JSON.stringify(payload),
   });
   
   if (!response.ok) {
     const errorData = await response.json().catch(() => ({}));
     throw new Error(errorData.error || '...');
   }
   
   return await response.json();
   ```

3. **νƒ€μ… μ¶”λ΅  λ¶κ°€**
   - IDEμ—μ„ API μ‘λ‹µ κµ¬μ΅°λ¥Ό μλ™ μ™„μ„±ν•  μ μ—†μ
   - νλΌλ―Έν„° κ²€μ¦μ„ λ°νƒ€μ„μ— μλ™μΌλ΅ ν•΄μ•Ό ν•¨

4. **URL ν•λ“μ½”λ”©**
   ```typescript
   fetch('/api/generate-review') // μ¤νƒ€ λ°μƒ μ‹ μ»΄νμΌ νƒ€μ„μ— κ°μ§€ λ¶κ°€
   ```

---

## **tRPC**λ€ λ¬΄μ—‡μΈκ°€?

**tRPC**λ” "TypeScript Remote Procedure Call"μ μ•½μλ΅, **νƒ€μ… μ•μ „ν• APIλ¥Ό λ§λ“¤κΈ° μ„ν• λΌμ΄λΈλ¬λ¦¬** μ…λ‹λ‹¤.

### ν•µμ‹¬ κ°λ…

- **μ—”λ“ν¬μ—”λ“ νƒ€μ… μ•μ •μ„±**: μ„λ²„μ—μ„ μ •μν• νƒ€μ…μ΄ ν΄λΌμ΄μ–ΈνΈμ— μλ™μΌλ΅ μ „λ‹¬.
- **RPC μ¤νƒ€μΌ**: RESTκ°€ μ•„λ‹ ν•¨μ νΈμ¶μ²λΌ API μ‚¬μ©.
- **Zero-runtime overhead**: νƒ€μ… μ •λ³΄λ” λΉλ“ μ‹μ—λ§ μ‚¬μ©λκ³  λ°νƒ€μ„μ—λ” μ κ±°λ¨.

### tRPCμ μ² ν•™

> If it compiles, it works.

μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μΌν• TypeScript μ½”λ“λ² μ΄μ¤λ¥Ό κ³µμ ν•λ©΄, μ»΄νμΌ νƒ€μ„μ— λ¨λ“  νƒ€μ… μ—λ¬λ¥Ό μ΅μ•„λ‚Ό μ μμµλ‹λ‹¤.

### μ™ "κ°™μ€ μ½”λ“λ² μ΄μ¤"μ—¬μ•Ό ν•λ”κ°€?

μ²μ tRPCλ¥Ό μ ‘ν–μ„ λ• μ΄ λ¶€λ¶„μ΄ μ μ΄ν•΄λμ§€ μ•μ•μµλ‹λ‹¤.  
μ™ ν’€μ¤νƒ TypeScript ν”„λ΅μ νΈμ—μ„λ§ μ‚¬μ©ν•  μ μλ” κ±ΈκΉμ”?

**ν•µμ‹¬μ€ TypeScript μ»΄νμΌλ¬κ°€ μ„λ²„ μ½”λ“λ¥Ό "μ§μ ‘ μ½μ–΄μ•Ό" ν•λ‹¤λ” κ²ƒ μ΄μ€μµλ‹λ‹¤.**

```typescript
// μ„λ²„ (src/server/routers/user.ts)
export const userRouter = router({
  getUser: publicProcedure.query(() => {
    return { name: "μ² μ", age: 30 };  // β† TypeScriptκ°€ μ΄ λ°ν™ νƒ€μ…μ„ μ¶”λ΅ 
  }),
});

// ν΄λΌμ΄μ–ΈνΈ (src/pages/index.tsx)
import type { AppRouter } from '@/server/routers/_app';  // β† μ„λ²„ νƒ€μ…μ„ import!

const { data } = trpc.user.getUser.useQuery();
// dataμ νƒ€μ…: { name: string; age: number } - μλ™ μ¶”λ΅ λ¨
```

ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ νƒ€μ… μ •μλ¥Ό **μ§μ ‘ import**ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤. λ§μ•½ μ„λ²„κ°€ Javaλ‚ PythonμΌλ΅ μ‘μ„±λμ–΄ μλ‹¤λ©΄, TypeScript μ»΄νμΌλ¬κ°€ κ·Έ μ½”λ“λ¥Ό μ½μ„ μ μ—†μΌλ‹, tRPC λ°©μ‹μ€ λ¶κ°€λ¥ν•©λ‹λ‹¤.

μ΄κ²ƒμ΄ tRPCμ **κ°•μ μ΄μ μ μ•½**μ΄ λμ–΄λ²„λ¦½λ‹λ‹¤.
- κ°•μ : νƒ€μ…μ΄ μλ™μΌλ΅ λ™κΈ°ν™”λ¨
- μ μ•½: ν”„λ΅ νΈμ—”λ“μ™€ λ°±μ—”λ“κ°€ κ°™μ€ TypeScript ν”„λ΅μ νΈμ—¬μ•Ό ν•¨

λ§μ•½, Next.js ν’€μ¤νƒ ν”„λ΅μ νΈλΌλ©΄, μ™„λ²½ν• μ΅°ν•©μ΄ λκ² μ£ .

### μ™Έλ¶€ λ°±μ—”λ“(Java/Python λ“±)λ¥Ό μ‚¬μ©ν•λ‹¤λ©΄?

tRPCλ” μ‚¬μ©ν•  μ μ—†μµλ‹λ‹¤. λ€μ‹  νƒ€μ… μ•μ •μ„±μ„ ν™•λ³΄ν•  μ μλ” λ€μ•λ“¤μ΄ μμµλ‹λ‹¤.

- **OpenAPI + μ½”λ“ μƒμ„±**: λ°±μ—”λ“μ Swagger μ¤ν™μ—μ„ TypeScript νƒ€μ…μ„ μλ™ μƒμ„±
- **GraphQL**: μ¤ν‚¤λ§ κΈ°λ°μΌλ΅ νƒ€μ… μλ™ μƒμ„±
- **μλ™ νƒ€μ… μ •μ**: API λ¬Έμ„λ¥Ό λ³΄κ³  μ§μ ‘ νƒ€μ… μ‘μ„± (μ μ§€λ³΄μ λΉ„μ© λ†’μ)

μ΄ κΈ€μ—μ„λ” Next.js ν’€μ¤νƒ ν™κ²½μ„ μ „μ λ΅ tRPCλ¥Ό λ‹¤λ£Ήλ‹λ‹¤.

---

## μ‹¤μ  μ½”λ“ λΉ„κµ

κ°™μ€ κΈ°λ¥μ„ Next.js API Routesμ™€ tRPCλ΅ κ°κ° κµ¬ν„ν•΄λ³΄κ² μµλ‹λ‹¤.

### μμ : λ¦¬λ·° μƒμ„± API

#### 1. Next.js API Routes λ°©μ‹

**μ„λ²„ (`app/api/generate-review/route.ts`)**

```typescript
import { NextRequest, NextResponse } from 'next/server';
import type { ReviewPayload } from '@/entities/review/model/types';

export async function POST(request: NextRequest) {
  try {
    const payload: ReviewPayload = await request.json();
    
    if (!payload.placeName || !payload.placeUrl) {
      return NextResponse.json(
        { error: 'ν•„μ ν•„λ“κ°€ λ„λ½λμ—μµλ‹λ‹¤.' },
        { status: 400 }
      );
    }

    const review = await generateReview(payload);
    
    return NextResponse.json({ 
      review, 
      message: 'μƒμ„± μ™„λ£' 
    });
  } catch (error) {
    return NextResponse.json(
      { error: 'μ„λ²„ μ¤λ¥' },
      { status: 500 }
    );
  }
}
```

**ν΄λΌμ΄μ–ΈνΈ (`src/features/review/api/review-api.ts`)**

```typescript
import type { ReviewPayload } from '@/entities/review/model/types';

export const generateReview = async (
  payload: ReviewPayload
): Promise<{ review: string; message: string }> => {
  const response = await fetch('/api/generate-review', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload),
  });

  if (!response.ok) {
    const errorData = await response.json().catch(() => ({}));
    throw new Error(errorData.error || 'λ¦¬λ·° μƒμ„±μ— μ‹¤ν¨ν–μµλ‹λ‹¤.');
  }

  // β οΈ νƒ€μ… λ‹¨μ–Έ ν•„μ” - λ°νƒ€μ„μ— κ²€μ¦λμ§€ μ•μ
  return (await response.json()) as { review: string; message: string };
};
```

**μ‚¬μ© (`μ»΄ν¬λ„νΈ`)**

```typescript
import { generateReview } from '@/features/review/api/review-api';

const result = await generateReview({
  placeName: 'μ„μΈ λ§›μ§‘',
  placeUrl: 'https://example.com',
  userDraft: 'λ§›μμ–΄μ”',
});
```

#### 2. `tRPC` λ°©μ‹

**μ„λ²„ (`src/server/routers/review.ts`)**

```typescript
import { z } from 'zod';
import { publicProcedure, router } from '../trpc';

// Zodλ¥Ό μ‚¬μ©ν• λ°νƒ€μ„ + νƒ€μ… κ²€μ¦
const reviewPayloadSchema = z.object({
  placeName: z.string().min(1, 'μ¥μ†λ…μ„ μ…λ ¥ν•΄μ£Όμ„Έμ”'),
  placeUrl: z.string().url('μ¬λ°”λ¥Έ URLμ„ μ…λ ¥ν•΄μ£Όμ„Έμ”'),
  userDraft: z.string().optional(),
});

export const reviewRouter = router({
  generate: publicProcedure
    .input(reviewPayloadSchema) // μλ™ κ²€μ¦
    .mutation(async ({ input }) => {
      const review = await generateReview(input);

      return {
        review,
        message: 'μƒμ„± μ™„λ£'
      };
    }),
});

export type ReviewRouter = typeof reviewRouter;
```

<aside data-type="info">
#### Zod ν†µν•©μ μ§„μ§ κ°€μΉ

μ²μμ—” "κ²€μ¦ μ½”λ“κ°€ μ¤„μ–΄λ“λ”κµ¬λ‚" μ •λ„λ΅ μƒκ°ν–μ—λ”λ°μ”, ν•μ§€λ§ μ§„μ§ κ°€μΉλ” λ‹¤λ¥Έ κ³³μ— μμ—μµλ‹λ‹¤.

**κΈ°μ΅΄ λ°©μ‹μ λ¬Έμ :**
- TypeScript νƒ€μ…: μ»΄νμΌ νƒ€μ„μ—λ§ μ΅΄μ¬ (λ°νƒ€μ„μ— μ‚¬λΌμ§)
- λ°νƒ€μ„ κ²€μ¦: λ³„λ„λ΅ μ‘μ„±ν•΄μ•Ό ν•¨
- β†’ λ‘μ΄ μ–΄κΈ‹λ‚λ©΄? λ²„κ·Έ. π¤―
</aside>

**Zod + tRPC:**
```typescript
// μ¤ν‚¤λ§ ν•λ‚λ΅ "λ°νƒ€μ„ κ²€μ¦"κ³Ό "νƒ€μ… μ •μ"λ¥Ό λ™μ‹μ—!
const reviewPayloadSchema = z.object({
  placeName: z.string().min(1),
  placeUrl: z.string().url(),
});

// μ΄ μ¤ν‚¤λ§μ—μ„ νƒ€μ…μ„ μ¶”μ¶ν•  μ μλ‹¤
type ReviewPayload = z.infer<typeof reviewPayloadSchema>;
// β†’ { placeName: string; placeUrl: string }

// tRPCμ—μ„ μ‚¬μ©ν•λ©΄
.input(reviewPayloadSchema)
.mutation(async ({ input }) => {
  // inputμ νƒ€μ…μ΄ μλ™μΌλ΅ ReviewPayload!
  // κ·Έλ¦¬κ³  λ°νƒ€μ„μ—λ„ μ‹¤μ λ΅ κ²€μ¦λ¨!
})
```

<aside data-type="success">
**μ¤ν‚¤λ§ ν•λ‚λ΅ νƒ€μ…κ³Ό κ²€μ¦μ„ λ™μ‹μ— μ •μν•λ‹¤.** μ λ€ μ–΄κΈ‹λ‚  μ μ—†λ‹¤.
μ΄ λ¶€λ¶„μ΄ μ •λ§ μ™€λ‹Ώμ•λ λ¶€λ¶„ μ΄μ€μµλ‹λ‹¤.
</aside>

#### Middlewareλ΅ μΈμ¦ λ΅μ§ μ¬μ‚¬μ©ν•κΈ°

tRPCμ λ λ‹¤λ¥Έ κ°•μ μ€ **λ―Έλ“¤μ›¨μ–΄**μ…λ‹λ‹¤. μΈμ¦ λ΅μ§μ„ ν• λ² μ •μν•΄λ‘λ©΄ μ—¬λ¬ ν”„λ΅μ‹μ €μ—μ„ μ¬μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

```typescript
// κ΄€λ¦¬μ μ „μ© ν”„λ΅μ‹μ € μ •μ
const adminProcedure = publicProcedure.use(({ ctx, next }) => {
  if (!ctx.user?.isAdmin) {
    throw new TRPCError({ code: 'UNAUTHORIZED' });
  }
  return next({ ctx: { ...ctx, user: ctx.user } });
});

// μ‚¬μ© μμ‹
export const adminRouter = router({
  getWhitelist: adminProcedure.query(async () => {
    // μ΄ μ½”λ“λ” κ΄€λ¦¬μλ§ μ‹¤ν–‰ κ°€λ¥
    return await db.whitelist.findMany();
  }),

  deleteUser: adminProcedure
    .input(z.object({ userId: z.string() }))
    .mutation(async ({ input }) => {
      // μ΄κ²ƒλ„ κ΄€λ¦¬μλ§ μ‹¤ν–‰ κ°€λ¥
      return await db.user.delete({ where: { id: input.userId } });
    }),
});
```

API Routesμ€λ‹¤λ©΄ λ§¤ ν•Έλ“¤λ¬λ§λ‹¤ μΈμ¦ μ²΄ν¬ μ½”λ“λ¥Ό λ°λ³µν•΄μ•Ό ν–μ„ κ²λ‹λ‹¤. tRPC λ―Έλ“¤μ›¨μ–΄λ” μ΄λ° ν΅λ‹¨ κ΄€μ‹¬μ‚¬(cross-cutting concerns)λ¥Ό κΉ”λ”ν•κ² λ¶„λ¦¬ν•΄μ¤λ‹λ‹¤.

**ν΄λΌμ΄μ–ΈνΈ (`src/utils/trpc.ts`)**

```typescript
import { createTRPCReact } from '@trpc/react-query';
import type { AppRouter } from '@/server/routers/_app';

export const trpc = createTRPCReact<AppRouter>();
```

**μ‚¬μ© (`μ»΄ν¬λ„νΈ`)**

```typescript
import { trpc } from '@/utils/trpc';

const generateMutation = trpc.review.generate.useMutation();

const handleGenerate = () => {
  generateMutation.mutate({
    placeName: 'μ„μΈ λ§›μ§‘',
    placeUrl: 'https://example.com',
    userDraft: 'λ§›μμ–΄μ”',
  }, {
    onSuccess: (data) => {
      // dataμ νƒ€μ…μ΄ μλ™μΌλ΅ μ¶”λ΅ λ¨!
      // data: { review: string; message: string }
      console.log(data.review);
    },
  });
};
```

---

## νƒ€μ… μ•μ •μ„± λΉ„κµ

### Next.js API Routesμ νƒ€μ… νλ¦„
![nextJs API Routes νλ¦„](/img/posts/20260119/i47amg2.png)

**λ¬Έμ μ :**
- μ„λ²„ μ‘λ‹µμ΄ λ°”λ€λ©΄ ν΄λΌμ΄μ–ΈνΈ νƒ€μ…μ„ μλ™μΌλ΅ μ—…λ°μ΄νΈν•΄μ•Ό ν•¨
- νƒ€μ… λ¶μΌμΉ μ‹ μ»΄νμΌ νƒ€μ„μ— κ°μ§€ λ¶κ°€
- `as` λ‹¨μ–ΈμΌλ΅ μΈν• νƒ€μ… μ•μ •μ„± μ €ν•

### tRPCμ νƒ€μ… νλ¦„

![tRPCμ νƒ€μ… νλ¦„](/img/posts/20260119/image.png)

**μ¥μ :**
- μ„λ²„ μ‘λ‹µμ΄ λ°”λ€λ©΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ¦‰μ‹ νƒ€μ… μ—λ¬ λ°μƒ
- μ»΄νμΌ νƒ€μ„μ— λ¨λ“  νƒ€μ… λ¶μΌμΉ κ°μ§€
- `as` λ‹¨μ–Έ λ¶ν•„μ”


---

## π” ν”„λ΅μ νΈλ³„ μ ν•©μ„± λ¶„μ„

### Next.js API Routesκ°€ μ ν•©ν• κ²½μ°

**λ‹¤μ μ΅°κ±΄μ— ν•΄λ‹Ήν•λ©΄ Next.js API Routes μ‚¬μ© κ¶μ¥ν•©λ‹λ‹¤.**

1. **μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈκ°€ APIλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ” κ²½μ°**
   - λ¨λ°”μΌ μ•± (React Native, Swift, Kotlin)
   - λ‹¤λ¥Έ μ›Ήμ‚¬μ΄νΈ
   - μ„λ“νν‹° μ„λΉ„μ¤ μ—°λ™
   
   tRPCλ” TypeScript ν΄λΌμ΄μ–ΈνΈλ§ μ§€μ›ν•λ―€λ΅ μ™Έλ¶€ μ†λΉ„μμ—κ²λ” λ¶€μ ν•©

   > **Tip**: μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ μ§€μ›μ΄ ν•„μ”ν•λ‹¤λ©΄ [trpc-openapi](https://github.com/jlalmes/trpc-openapi)λ¥Ό ν™μ©ν•΄λ³΄μ„Έμ”. tRPC λΌμ°ν„°μ—μ„ REST APIλ¥Ό μλ™ μƒμ„±ν•  μ μμµλ‹λ‹¤.

2. **μ›Ήν›…μ΄λ‚ κ³µκ° APIλ¥Ό μ κ³µν•΄μ•Ό ν•λ” κ²½μ°**
   ```typescript
   // Stripe μ›Ήν›…, GitHub μ›Ήν›… λ“±
   POST /api/webhooks/stripe
   ```

3. **ν”„λ΅μ νΈ κ·λ¨κ°€ μ‘μ€ κ²½μ°**
   - API μ—”λ“ν¬μΈνΈκ°€ 5κ° μ΄ν•
   - νƒ€μ… λ¶μΌμΉλ΅ μΈν• λ²„κ·Έ μ„ν—μ΄ λ‚®μ

4. **ν€μ›λ“¤μ΄ TypeScriptμ— μµμ™ν•μ§€ μ•μ€ κ²½μ°**
   - REST APIλ” λ” μ§κ΄€μ μ΄κ³  ν•™μµ κ³΅μ„ μ΄ λ‚®μ

### tRPCκ°€ μ ν•©ν• κ²½μ°

**λ‹¤μ μ΅°κ±΄μ— ν•΄λ‹Ήν•λ©΄ tRPC μ‚¬μ© κ¶μ¥ν•©λ‹λ‹¤.**

1. **ν’€μ¤νƒ TypeScript ν”„λ΅μ νΈ**
   - Next.js + TypeScriptλ΅ ν”„λ΅ νΈμ—”λ“μ™€ λ°±μ—”λ“ λ¨λ‘ κ°λ°
   - μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ μ§€μ›μ΄ λ¶ν•„μ”

2. **λΉ λ¥΄κ² λ³€ν™”ν•λ” ν”„λ΅μ νΈ**
   - API μ¤ν™μ΄ μμ£Ό λ³€κ²½λ¨
   - λ¦¬ν©ν† λ§μ΄ μ¦μ
   - νƒ€μ… μ•μ •μ„±μΌλ΅ λ²„κ·Έ μ‚¬μ „ λ°©μ§€ ν•„μ”

3. **μ¤‘λ€ν• ν”„λ΅μ νΈ**
   - API μ—”λ“ν¬μΈνΈκ°€ 10κ° μ΄μƒ
   - μ—¬λ¬ κ°λ°μκ°€ λ™μ‹μ— μ‘μ—…
   - νƒ€μ… λ¶μΌμΉλ΅ μΈν• λ²„κ·Έ λΉ„μ©μ΄ νΌ

4. **DX(Developer Experience)λ¥Ό μ¤‘μ‹ν•λ” κ²½μ°**
   - μλ™μ™„μ„±, νƒ€μ… μ¶”λ΅  λ“±μΌλ΅ μƒμ‚°μ„± ν–¥μƒ
   - λ¦¬ν©ν† λ§ μ•μ •μ„± ν™•λ³΄

---

## μ§„ν–‰μ¤‘μΈ ν”„λ΅μ νΈμ— tRPCλ¥Ό λ„μ…ν•λ‹¤λ©΄?

<aside data-type="warning">
μ•„μ§ λ¦¬ν©ν† λ§μ¤‘μ— μμΌλ©° ν•΄λ‹Ή λ¶€λ¶„μ€ AIμ λ„μ›€μ„ λ°›μ•„ κ°€μ •ν• κ²°κ³Όμ…λ‹λ‹¤.
</aside>

### ν„μ¬ μƒν™©

```
API μ—”λ“ν¬μΈνΈ:
- /api/generate-review (POST)
- /api/edit-review (POST)
- /api/analyze-style (POST)
- /api/style-profile (GET, POST)
- /api/admin/prompts (GET, POST)
- /api/admin/prompts/[id] (GET, PUT, DELETE)
- /api/admin/whitelist (GET, POST, PUT, DELETE)
```

**μ΄ 7κ°μ μ£Όμ” API λΌμ°νΈ**, μ•½ 15κ°μ μ—”λ“ν¬μΈνΈ

### tRPC λ„μ… μ‹ μμƒ κ°μ„ μ‚¬ν•­

#### 1. νƒ€μ… μ•μ •μ„± ν™•λ³΄

**ν„μ¬ (useWhitelist.ts):**

```typescript
const response = await fetch('/api/admin/whitelist', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-Admin-Password': password,
  },
  body: JSON.stringify({
    email: email.trim(),
    notes: notes.trim() || undefined,
  }),
});

const data = await response.json();
// β οΈ dataμ νƒ€μ…: any
```

**tRPCλ΅ μ „ν™ ν›„:**

```typescript
const addUserMutation = trpc.admin.whitelist.add.useMutation();

addUserMutation.mutate({
  email: email.trim(),
  notes: notes.trim() || undefined,
}, {
  onSuccess: (data) => {
    // β… data: { user: ApprovedUser }
    // β… νƒ€μ… μ•μ „, μλ™μ™„μ„± μ§€μ›
  },
});
```

#### 2. μ½”λ“ μ¤‘λ³µ μ κ±°

**ν„μ¬ λ°λ³µλλ” ν¨ν„΄:**

```typescript
// useWhitelist.tsμ—λ§ 4λ² λ°λ³µ
const response = await fetch('/api/admin/whitelist', {
  method: '...',
  headers: { 'X-Admin-Password': password },
  body: JSON.stringify(...),
});

if (!response.ok) {
  throw new Error('...');
}

const data = await response.json();
```

**tRPCλ΅ μ „ν™ ν›„:**

```typescript
// ν• μ¤„λ΅ ν•΄κ²°
trpc.admin.whitelist.list.useQuery();
trpc.admin.whitelist.add.useMutation();
trpc.admin.whitelist.update.useMutation();
trpc.admin.whitelist.delete.useMutation();
```

**μ¥κΈ°μ  μ΄μ **: 
- νƒ€μ… λ¶μΌμΉ λ²„κ·Έ κ°μ† β†’ QA μ‹κ°„ λ‹¨μ¶•
- μƒλ΅μ΄ API κ°λ° μ†λ„ ν–¥μƒ (~30% λΉ λ¦„)
- λ¦¬ν©ν† λ§ μ•μ •μ„± ν–¥μƒ

### μ½”λ“ λ³€ν™” μ”μ•½

| ν•­λ© | Before (API Routes) | After (tRPC) |
|------|---------------------|--------------|
| **μ„λ²„ μ½”λ“ λΌμΈ μ** | ~80μ¤„ | ~60μ¤„ (-25%) |
| **ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λΌμΈ μ** | ~100μ¤„ | ~45μ¤„ (-55%) |
| **νƒ€μ… μ•μ •μ„±** | μλ™ νƒ€μ… λ‹¨μ–Έ | μλ™ νƒ€μ… μ¶”λ΅  |
| **μ—λ¬ μ²λ¦¬** | μλ™ | React Query ν†µν•© |
| **μƒνƒ κ΄€λ¦¬** | useState | React Query (μλ™ μΊμ‹±) |
| **λ³΄μΌλ¬ν”λ μ΄νΈ** | λ§μ | μ μ |

---

## μ–Έμ  λ¬΄μ—‡μ„ μ„ νƒν•΄μ•Ό ν• κΉ?

### μμ‚¬κ²°μ • ν”λ΅μ°μ°¨νΈ

```
TypeScriptλ¥Ό μ‚¬μ©ν•λ”κ°€?
  β”β”€ No β†’ Next.js API Routes
  β””β”€ Yes
      β”β”€ μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ μ§€μ›μ΄ ν•„μ”ν•κ°€?
      β”‚   β”β”€ Yes β†’ Next.js API Routes (λλ” tRPC + REST νΌμ©)
      β”‚   β””β”€ No
      β”‚       β”β”€ API μ—”λ“ν¬μΈνΈκ°€ 10κ° μ΄μƒμΈκ°€?
      β”‚       β”‚   β”β”€ Yes β†’ tRPC κ°•λ ¥ μ¶”μ²
      β”‚       β”‚   β””β”€ No
      β”‚       β”‚       β”β”€ νƒ€μ… μ•μ •μ„±μ„ μ¤‘μ‹ν•λ”κ°€?
      β”‚       β”‚       β”‚   β”β”€ Yes β†’ tRPC κ¶μ¥
      β”‚       β”‚       β”‚   β””β”€ No β†’ Next.js API Routes
```

### μ”μ•½ κ°€μ΄λ“

| κΈ°μ¤€ | Next.js API Routes | tRPC |
|------|-------------------|------|
| **ν”„λ΅μ νΈ κ·λ¨** | μ†ν• (~5 API) | μ¤‘λ€ν• (10+ API) |
| **νƒ€μ… μ•μ •μ„±** | μλ™ κ΄€λ¦¬ | μλ™ λ³΄μ¥ |
| **μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ** | μ§€μ› | λ―Έμ§€μ›  |
| **ν•™μµ κ³΅μ„ ** | λ‚®μ | μ¤‘κ°„ |
| **κ°λ° μ†λ„** | μ΄κΈ°: λΉ λ¦„<br/>μ¥κΈ°: λ³΄ν†µ | μ΄κΈ°: λ³΄ν†µ<br/>μ¥κΈ°: λΉ λ¦„ |
| **λ¦¬ν©ν† λ§** | μλ™, μ„ν— | μλ™, μ•μ „ |
| **λ²λ“¤ μ‚¬μ΄μ¦** | 0KB | ~15KB (gzipped) |

---

## κ²°λ΅ 

### κ°κ΄€μ  λΉ„κµ μ”μ•½

**Next.js API Routesμ κ°•μ :**
- λΉ λ¥Έ μ‹μ‘, λ‚®μ€ μ§„μ… μ¥λ²½
- REST API ν‘μ¤€ μ¤€μ
- μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ μ§€μ›

**tRPCμ κ°•μ :**
- μ—”λ“ν¬μ—”λ“ νƒ€μ… μ•μ •μ„±
- μλ™μ™„μ„± λ° νƒ€μ… μ¶”λ΅ 
- λ³΄μΌλ¬ν”λ μ΄νΈ μ κ±°
- λ¦¬ν©ν† λ§ μ•μ •μ„±

---

### λ‚μ μ„ νƒ

**ν„μ¬ μƒν™©**: 15κ°μ μ—”λ“ν¬μΈνΈ, ν’€μ¤νƒ TypeScript ν”„λ΅μ νΈ

**κ²°μ •**: tRPCλ΅ μ „ν™

```typescript
return (await response.json()) as { review: string; message: string };
```

μ΄ `as`λ¥Ό λ” μ΄μƒ μ“°κ³  μ‹¶μ§€ μ•μ•μµλ‹λ‹¤.

tRPCλ¥Ό λ„μ…ν•λ©΄ λ²λ“¤ μ‚¬μ΄μ¦κ°€ μ•½ 15KB λμ–΄λ‚λ‹¤κ³  ν•©λ‹λ‹¤. (μ•„μ§ λ¦¬ν©ν† λ§μ¤‘μ΄λΌ μ λ€λ΅ μΈ΅μ •μ„ λ»ν•κ³  μκΈ΄ν•©λ‹λ‹¤. λ¦¬ν©ν† λ§ ν›„μ— κΈ€μ„ μμ •ν•  μμ •μ΄μ—μ”!)  
λ¬Όλ΅  React Queryλ„ ν•¨κ» λ“¤μ–΄μ¤κΈ°μ— ν•™μµ λΉ„μ©λ„ μμµλ‹λ‹¤.  
ν•μ§€λ§ **"μ„λ²„ μ‘λ‹µμ΄ λ°”λ€λ©΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ¦‰μ‹ μ»΄νμΌ μ—λ¬κ°€ λ‚λ‹¤"** λ” κ²ƒ. μ΄ ν•λ‚μ μ΄μ μ΄ λ¨λ“  λΉ„μ©μ„ μƒμ‡„ν•λ‹¤κ³  νλ‹¨ν–μµλ‹λ‹¤.

ν”„λ΅λ•μ…μ—μ„ `undefined` μ—λ¬λ¥Ό λ””λ²„κΉ…ν•λ” κ²ƒλ³΄λ‹¤, IDEμ—μ„ λΉ¨κ°„ μ¤„μ„ λ³΄λ” κ² λ‚«κ±°λ“ μ”.

λ¬Όλ΅  λ¨λ“  ν”„λ΅μ νΈμ— tRPCκ°€ μ •λ‹µμ€ μ•„λ‹™λ‹λ‹¤.  
μ™Έλ¶€ APIλ¥Ό μ κ³µν•΄μ•Ό ν•λ‹¤λ©΄ Next.js API Routesκ°€ λ§μ„μλ„ μμ–΄μ”. λΏλ§μ•„λ‹λΌ, μ†κ·λ¨ ν”„λ΅μ νΈλΌλ©΄ μ¤λ²„μ—”μ§€λ‹μ–΄λ§μΌ μ μμµλ‹λ‹¤.

κ·Έλ¬λ‚, **νƒ€μ… λ¶μΌμΉ λ²„κ·Έλ΅ κ³ μƒν•΄λ³Έ κ²½ν—**μ΄ μλ‹¤λ©΄, tRPCλ” ν™•μ‹¤ν κ²€ν† ν•΄λ³Ό κ°€μΉκ°€ μμ§€ μ•μ„κΉ μ‹¶μµλ‹λ‹¤.

---

## μ°Έκ³  μλ£

- [tRPC κ³µμ‹ λ¬Έμ„](https://trpc.io)
- [Next.js Route Handlers λ¬Έμ„](https://nextjs.org/docs/app/api-reference/file-conventions/route)
